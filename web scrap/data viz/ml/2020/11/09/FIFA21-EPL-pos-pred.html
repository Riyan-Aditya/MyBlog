<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>FIFA21 EPL analysis | MyBlog</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="FIFA21 EPL analysis" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Unsupervised learning - prediction of FIFA21 players’ position" />
<meta property="og:description" content="Unsupervised learning - prediction of FIFA21 players’ position" />
<link rel="canonical" href="https://riyan-aditya.github.io//MyBlog/web%20scrap/data%20viz/ml/2020/11/09/FIFA21-EPL-pos-pred.html" />
<meta property="og:url" content="https://riyan-aditya.github.io//MyBlog/web%20scrap/data%20viz/ml/2020/11/09/FIFA21-EPL-pos-pred.html" />
<meta property="og:site_name" content="MyBlog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-11-09T00:00:00-06:00" />
<script type="application/ld+json">
{"url":"https://riyan-aditya.github.io//MyBlog/web%20scrap/data%20viz/ml/2020/11/09/FIFA21-EPL-pos-pred.html","@type":"BlogPosting","headline":"FIFA21 EPL analysis","dateModified":"2020-11-09T00:00:00-06:00","datePublished":"2020-11-09T00:00:00-06:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://riyan-aditya.github.io//MyBlog/web%20scrap/data%20viz/ml/2020/11/09/FIFA21-EPL-pos-pred.html"},"description":"Unsupervised learning - prediction of FIFA21 players’ position","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/MyBlog/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://riyan-aditya.github.io//MyBlog/feed.xml" title="MyBlog" /><!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-57531313-5','auto');ga('require','displayfeatures');ga('send','pageview');</script>

<link rel="shortcut icon" type="image/x-icon" href="/MyBlog/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/MyBlog/">MyBlog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/MyBlog/about/">About Me</a><a class="page-link" href="/MyBlog/categories/">Contents</a><a class="page-link" href="/MyBlog/search/">Search</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">FIFA21 EPL analysis</h1><p class="page-description">Unsupervised learning - prediction of FIFA21 players' position</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-11-09T00:00:00-06:00" itemprop="datePublished">
        Nov 9, 2020
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      15 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/MyBlog/categories/#Web scrap">Web scrap</a>
        &nbsp;
      
        <a class="category-tags-link" href="/MyBlog/categories/#Data Viz">Data Viz</a>
        &nbsp;
      
        <a class="category-tags-link" href="/MyBlog/categories/#ML">ML</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/Riyan-Aditya/MyBlog/tree/master/_notebooks/2020-11-09-FIFA21-EPL-pos-pred.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/MyBlog/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/Riyan-Aditya/MyBlog/master?filepath=_notebooks%2F2020-11-09-FIFA21-EPL-pos-pred.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/MyBlog/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/Riyan-Aditya/MyBlog/blob/master/_notebooks/2020-11-09-FIFA21-EPL-pos-pred.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/MyBlog/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h1"><a href="#Import-python-module">Import python module </a></li>
<li class="toc-entry toc-h1"><a href="#Webscrap-FIFA21-EPL-players'-stats">Webscrap FIFA21 EPL players&#39; stats </a>
<ul>
<li class="toc-entry toc-h2"><a href="#Grab-list-of-EPL-players">Grab list of EPL players </a></li>
<li class="toc-entry toc-h2"><a href="#Scrap-individual-player-stats">Scrap individual player stats </a></li>
<li class="toc-entry toc-h2"><a href="#Save-JSON-data-of-FIFA21-EPL-players">Save JSON data of FIFA21 EPL players </a></li>
<li class="toc-entry toc-h2"><a href="#Load-data-for-later-use">Load data for later use </a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#Data-cleaning">Data cleaning </a>
<ul>
<li class="toc-entry toc-h2"><a href="#Traits">Traits </a></li>
<li class="toc-entry toc-h2"><a href="#Convert-to-numeric">Convert to numeric </a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#Top-players-of-Fifa21">Top players of Fifa21 </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-11-09-FIFA21-EPL-pos-pred.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Objective of this notebook:</p>
<ul>
<li>Apply webscrap by myself</li>
<li>Visualise FIFA21 player data</li>
<li>Unsupervised learning to predict players' position</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note book summary:</p>
<ul>
<li>Create python script (BeautifulSoup) to scrap FIFA21 EPL players data from <a href="https://sofifa.com/">https://sofifa.com/</a> </li>
<li>Clean data</li>
<li>Gained information from the data</li>
<li>Simplify position</li>
<li>Train test split via stratified sampling</li>
<li>Predict position =&gt; <strong>90% accuracy and F1 score for the test set via SVM</strong>
</li>
<li>Midfielders are the position that are hardest to predict</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Inspired by this analysis from Kaggle: <a href="https://www.kaggle.com/younessennadj/fifa19-analytics-predict-position#4.Divide-the-data-to-train-and-test-datasets">https://www.kaggle.com/younessennadj/fifa19-analytics-predict-position#4.Divide-the-data-to-train-and-test-datasets</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Import-python-module">
<a class="anchor" href="#Import-python-module" aria-hidden="true"><span class="octicon octicon-link"></span></a>Import python module<a class="anchor-link" href="#Import-python-module"> </a>
</h1>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span> <span class="k">as</span> <span class="n">bs</span>

<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">randrange</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Webscrap-FIFA21-EPL-players'-stats">
<a class="anchor" href="#Webscrap-FIFA21-EPL-players'-stats" aria-hidden="true"><span class="octicon octicon-link"></span></a>Webscrap FIFA21 EPL players' stats<a class="anchor-link" href="#Webscrap-FIFA21-EPL-players'-stats"> </a>
</h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First, check if you can webscrap. sofifa.com indicate you can webscrap through their robots.txt</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Webscrap procedure:</p>
<ul>
<li>Search prem players in Fifa21</li>
<li>Results are stored in table, 60 per page. up to 600</li>
<li>open each pages, grab the link to pages for individual players</li>
</ul>
<p>Note: scrap responsibly. Add a random 2-6 seconds delay in between access to webpages</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Grab-list-of-EPL-players">
<a class="anchor" href="#Grab-list-of-EPL-players" aria-hidden="true"><span class="octicon octicon-link"></span></a>Grab list of EPL players<a class="anchor-link" href="#Grab-list-of-EPL-players"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">links</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="c1"># make a search and scrap the webpage --------------------------------------------------</span>
    <span class="n">base_url</span> <span class="o">=</span> <span class="s1">'https://sofifa.com/players?type=all&amp;lg%5B%5D=13'</span>
    
    
    <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">add_url</span> <span class="o">=</span><span class="s1">'&amp;offset='</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">add_url</span><span class="o">=</span><span class="s1">''</span>

    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">base_url</span><span class="o">+</span><span class="n">add_url</span><span class="p">)</span>
    
    <span class="c1"># call the soup function to make the html readable --------------------------------------</span>
    <span class="n">webpage</span> <span class="o">=</span> <span class="n">bs</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
    <span class="n">table</span> <span class="o">=</span> <span class="n">webpage</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">'table'</span><span class="p">)</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">'tr'</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">[</span><span class="mi">1</span><span class="p">::]:</span>
        <span class="n">link</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,{</span><span class="s2">"class"</span><span class="p">:</span><span class="s2">"tooltip"</span><span class="p">})[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">links</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">link</span><span class="p">[</span><span class="s1">'href'</span><span class="p">])</span>
    
    <span class="c1"># print progress on scrapping link</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Page"</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="s2">"done"</span><span class="p">)</span>
    
    <span class="c1">#Be sure to pause</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">randrange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Page 0 done
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Number of players in EPL:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">links</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>60</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The top 10 players, sorted by overall rating:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">links</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>['/player/192985/kevin-de-bruyne/210012/',
 '/player/212831/alisson-ramses-becker/210012/',
 '/player/209331/mohamed-salah/210012/',
 '/player/208722/sadio-mane/210012/',
 '/player/203376/virgil-van-dijk/210012/',
 '/player/153079/sergio-aguero/210012/',
 '/player/202126/harry-kane/210012/',
 '/player/215914/ngolo-kante/210012/',
 '/player/210257/ederson-santana-de-moraes/210012/',
 '/player/202652/raheem-sterling/210012/']</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Ok, we have 644 players registered in EPL in the FIFA21 game. That is 32 players per club which is about right</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Scrap-individual-player-stats">
<a class="anchor" href="#Scrap-individual-player-stats" aria-hidden="true"><span class="octicon octicon-link"></span></a>Scrap individual player stats<a class="anchor-link" href="#Scrap-individual-player-stats"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note: I have scrapped them before using the same function below. For for this demo, I will only scrap the first 10 players</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">links3</span> <span class="o">=</span> <span class="n">links</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Players to scrap (show first 5):</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">links3</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>['/player/192985/kevin-de-bruyne/210012/',
 '/player/212831/alisson-ramses-becker/210012/',
 '/player/209331/mohamed-salah/210012/',
 '/player/208722/sadio-mane/210012/',
 '/player/203376/virgil-van-dijk/210012/']</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Use function to scrap</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">list_stats_top10</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">def</span> <span class="nf">player_name</span><span class="p">(</span><span class="n">weblink</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">weblink</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">'h1'</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>

<span class="k">def</span> <span class="nf">nat</span><span class="p">(</span><span class="n">weblink</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">weblink</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">'div'</span><span class="p">,{</span><span class="s2">"class"</span><span class="p">:</span><span class="s2">"meta bp3-text-overflow-ellipsis"</span><span class="p">})</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="s1">'title'</span><span class="p">]</span>
    
<span class="k">def</span> <span class="nf">dob_wh</span><span class="p">(</span><span class="n">weblink</span><span class="p">):</span>
    <span class="n">stuff</span> <span class="o">=</span> <span class="n">weblink</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">'div'</span><span class="p">,{</span><span class="s2">"class"</span><span class="p">:</span><span class="s2">"meta bp3-text-overflow-ellipsis"</span><span class="p">})</span><span class="o">.</span><span class="n">text</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">stuff</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">"("</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">dob</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">")"</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">temp2</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">")"</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">" "</span><span class="p">)</span>
    <span class="n">height</span> <span class="o">=</span> <span class="n">temp2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">weight</span> <span class="o">=</span> <span class="n">temp2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">dob</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">weight</span>

<span class="k">def</span> <span class="nf">club_info</span><span class="p">(</span><span class="n">weblink</span><span class="p">):</span>
    <span class="n">club</span> <span class="o">=</span> <span class="n">weblink</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">'Player Specialities'</span><span class="p">))</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">findNext</span><span class="p">(</span><span class="s1">'h5'</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">jersey</span> <span class="o">=</span> <span class="n">weblink</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">'Jersey Number'</span><span class="p">))</span><span class="o">.</span><span class="n">next</span>
    <span class="n">c_valid</span> <span class="o">=</span> <span class="n">weblink</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">'Contract Valid Until'</span><span class="p">))</span><span class="o">.</span><span class="n">next</span>
    <span class="n">c_value</span> <span class="o">=</span> <span class="n">weblink</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">'section'</span><span class="p">,{</span><span class="s2">"class"</span><span class="p">:</span><span class="s2">"card spacing"</span><span class="p">})</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">'Value'</span><span class="p">))</span><span class="o">.</span><span class="n">previous</span><span class="o">.</span><span class="n">previous</span>
    <span class="n">wage</span> <span class="o">=</span> <span class="n">weblink</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">'section'</span><span class="p">,{</span><span class="s2">"class"</span><span class="p">:</span><span class="s2">"card spacing"</span><span class="p">})</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">'Wage'</span><span class="p">))</span><span class="o">.</span><span class="n">previous</span><span class="o">.</span><span class="n">previous</span>
    <span class="k">return</span> <span class="n">club</span><span class="p">,</span> <span class="n">jersey</span><span class="p">,</span> <span class="n">c_valid</span><span class="p">,</span> <span class="n">c_value</span><span class="p">,</span> <span class="n">wage</span>

<span class="k">def</span> <span class="nf">player_stats</span><span class="p">(</span><span class="n">weblink</span><span class="p">):</span>
    <span class="n">best_pos</span> <span class="o">=</span> <span class="n">weblink</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">'Best Position'</span><span class="p">))</span><span class="o">.</span><span class="n">next</span><span class="o">.</span><span class="n">text</span>
    <span class="n">best_rating</span> <span class="o">=</span> <span class="n">weblink</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">'Best Overall Rating'</span><span class="p">))</span><span class="o">.</span><span class="n">next</span><span class="o">.</span><span class="n">text</span>
    <span class="k">return</span> <span class="n">best_pos</span><span class="p">,</span> <span class="n">best_rating</span>
    
<span class="k">def</span> <span class="nf">player_stats_detail</span><span class="p">(</span><span class="n">weblink</span><span class="p">):</span>
    
    <span class="c1"># Attacking stats</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">weblink</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">'Attacking'</span><span class="p">))</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">"li"</span><span class="p">)</span>
    <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Crossing'</span><span class="p">,</span><span class="s1">'Finishing'</span><span class="p">,</span><span class="s1">'Heading Accuracy'</span><span class="p">,</span><span class="s1">'Short Passing'</span><span class="p">,</span><span class="s1">'Volleys'</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span><span class="n">attrs</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">temp</span><span class="p">):</span>
        <span class="n">temp2</span> <span class="o">=</span> <span class="n">attrs</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">'span'</span><span class="p">)</span>
        <span class="n">stats</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">index</span><span class="p">]]</span> <span class="o">=</span> <span class="n">temp2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span>
    
    <span class="c1"># skill stats</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">weblink</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">'Attacking'</span><span class="p">))</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">find_next_sibling</span><span class="p">(</span><span class="s2">"div"</span><span class="p">)</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">"li"</span><span class="p">)</span>
    <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Dribbling'</span><span class="p">,</span><span class="s1">'Curve'</span><span class="p">,</span><span class="s1">'FK Accuracy'</span><span class="p">,</span><span class="s1">'Long Passing'</span><span class="p">,</span><span class="s1">'Ball Control'</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span><span class="n">attrs</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">temp</span><span class="p">):</span>
        <span class="n">temp2</span> <span class="o">=</span> <span class="n">attrs</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">'span'</span><span class="p">)</span>
        <span class="n">stats</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">index</span><span class="p">]]</span> <span class="o">=</span> <span class="n">temp2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span>
    
    <span class="c1"># movement stats</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">weblink</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">'Movement'</span><span class="p">))</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">"li"</span><span class="p">)</span>
    <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Acceleration'</span><span class="p">,</span><span class="s1">'Spring Speed'</span><span class="p">,</span><span class="s1">'Agility'</span><span class="p">,</span><span class="s1">'Reactions'</span><span class="p">,</span><span class="s1">'Balance'</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span><span class="n">attrs</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">temp</span><span class="p">):</span>
        <span class="n">temp2</span> <span class="o">=</span> <span class="n">attrs</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">'span'</span><span class="p">)</span>
        <span class="n">stats</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">index</span><span class="p">]]</span> <span class="o">=</span> <span class="n">temp2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span>

    <span class="c1"># power stats</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">weblink</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">'Power'</span><span class="p">))</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">"li"</span><span class="p">)</span>
    <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Shot Power'</span><span class="p">,</span><span class="s1">'Jumping'</span><span class="p">,</span><span class="s1">'Stamina'</span><span class="p">,</span><span class="s1">'Strength'</span><span class="p">,</span><span class="s1">'Long Shots'</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span><span class="n">attrs</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">temp</span><span class="p">):</span>
        <span class="n">temp2</span> <span class="o">=</span> <span class="n">attrs</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">'span'</span><span class="p">)</span>
        <span class="n">stats</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">index</span><span class="p">]]</span> <span class="o">=</span> <span class="n">temp2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span>
    
    
    <span class="c1"># mentality stats</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">weblink</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">'Mentality'</span><span class="p">))</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">"li"</span><span class="p">)</span>
    <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Aggression'</span><span class="p">,</span><span class="s1">'Interceptions'</span><span class="p">,</span><span class="s1">'Positioning'</span><span class="p">,</span><span class="s1">'Vision'</span><span class="p">,</span><span class="s1">'Penalties'</span><span class="p">,</span><span class="s1">'Composure'</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span><span class="n">attrs</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">temp</span><span class="p">):</span>
        <span class="n">temp2</span> <span class="o">=</span> <span class="n">attrs</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">'span'</span><span class="p">)</span>
        <span class="n">stats</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">index</span><span class="p">]]</span> <span class="o">=</span> <span class="n">temp2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span>
    
    <span class="c1"># defending stats</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">weblink</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">'Defending'</span><span class="p">))</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">"li"</span><span class="p">)</span>
    <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Defensive Awareness'</span><span class="p">,</span><span class="s1">'Standing Tackle'</span><span class="p">,</span><span class="s1">'Sliding Tackle'</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span><span class="n">attrs</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">temp</span><span class="p">):</span>
        <span class="n">temp2</span> <span class="o">=</span> <span class="n">attrs</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">'span'</span><span class="p">)</span>
        <span class="n">stats</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">index</span><span class="p">]]</span> <span class="o">=</span> <span class="n">temp2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span>
    
    <span class="c1"># goalkeeping stats</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">weblink</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">'Goalkeeping'</span><span class="p">))</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">"li"</span><span class="p">)</span>
    <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'GK Diving'</span><span class="p">,</span><span class="s1">'GK Handling'</span><span class="p">,</span><span class="s1">'GK Kicking'</span><span class="p">,</span><span class="s1">'GK Positioning'</span><span class="p">,</span><span class="s1">'GK Reflexes'</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span><span class="n">attrs</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">temp</span><span class="p">):</span>
        <span class="n">temp2</span> <span class="o">=</span> <span class="n">attrs</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">'span'</span><span class="p">)</span>
        <span class="n">stats</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">index</span><span class="p">]]</span> <span class="o">=</span> <span class="n">temp2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span>
    
    <span class="c1"># traits stats</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="n">weblink</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">'Traits'</span><span class="p">))</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">"li"</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">attrs</span> <span class="ow">in</span> <span class="n">temp</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">'Traits'</span> <span class="ow">in</span> <span class="n">stats</span><span class="p">:</span>
                <span class="n">stats</span><span class="p">[</span><span class="s1">'Traits'</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attrs</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">stats</span><span class="p">[</span><span class="s1">'Traits'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">attrs</span><span class="o">.</span><span class="n">text</span><span class="p">]</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">stats</span><span class="p">[</span><span class="s1">'Traits'</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    
<span class="k">for</span> <span class="n">index</span><span class="p">,</span><span class="n">link</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">links3</span><span class="p">):</span>
    <span class="c1"># make a search and scrap the webpage --------------------------------------------------</span>
    <span class="n">base_url</span> <span class="o">=</span> <span class="s1">'https://sofifa.com/'</span>
    <span class="n">add_url</span> <span class="o">=</span> <span class="n">link</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">base_url</span><span class="o">+</span><span class="n">add_url</span><span class="p">)</span>
    <span class="n">weblink</span> <span class="o">=</span> <span class="n">bs</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
    
    <span class="n">stats</span><span class="o">=</span><span class="p">{}</span>
    
    <span class="c1"># get player name</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">player_name</span><span class="p">(</span><span class="n">weblink</span><span class="p">)</span>
    <span class="n">stats</span><span class="p">[</span><span class="s1">'Player_name'</span><span class="p">]</span> <span class="o">=</span> <span class="n">name</span>
    
    <span class="c1"># get nationality</span>
    <span class="n">nationality</span> <span class="o">=</span> <span class="n">nat</span><span class="p">(</span><span class="n">weblink</span><span class="p">)</span>
    <span class="n">stats</span><span class="p">[</span><span class="s1">'Nationality'</span><span class="p">]</span> <span class="o">=</span> <span class="n">nationality</span>
    
    <span class="c1"># get dob, weight, height</span>
    <span class="n">dob</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">weight</span> <span class="o">=</span> <span class="n">dob_wh</span><span class="p">(</span><span class="n">weblink</span><span class="p">)</span>
    <span class="n">stats</span><span class="p">[</span><span class="s1">'dob'</span><span class="p">]</span> <span class="o">=</span> <span class="n">dob</span>
    <span class="n">stats</span><span class="p">[</span><span class="s1">'height'</span><span class="p">]</span> <span class="o">=</span> <span class="n">height</span>
    <span class="n">stats</span><span class="p">[</span><span class="s1">'weight'</span><span class="p">]</span> <span class="o">=</span> <span class="n">weight</span>
    
    <span class="c1"># get club info</span>
    <span class="n">club</span><span class="p">,</span> <span class="n">jersey</span><span class="p">,</span> <span class="n">c_valid</span><span class="p">,</span> <span class="n">c_value</span><span class="p">,</span> <span class="n">wage</span> <span class="o">=</span> <span class="n">club_info</span><span class="p">(</span><span class="n">weblink</span><span class="p">)</span>
    <span class="n">stats</span><span class="p">[</span><span class="s1">'club'</span><span class="p">]</span> <span class="o">=</span> <span class="n">club</span>
    <span class="n">stats</span><span class="p">[</span><span class="s1">'jersey'</span><span class="p">]</span> <span class="o">=</span> <span class="n">jersey</span>
    <span class="n">stats</span><span class="p">[</span><span class="s1">'c_valid'</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_valid</span>
    <span class="n">stats</span><span class="p">[</span><span class="s1">'c_value'</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_value</span>
    <span class="n">stats</span><span class="p">[</span><span class="s1">'wage'</span><span class="p">]</span> <span class="o">=</span> <span class="n">wage</span>
    
    <span class="c1"># add general player stats</span>
    <span class="n">pos</span><span class="p">,</span> <span class="n">rating</span> <span class="o">=</span> <span class="n">player_stats</span><span class="p">(</span><span class="n">weblink</span><span class="p">)</span>
    <span class="n">stats</span><span class="p">[</span><span class="s1">'pos'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pos</span>
    <span class="n">stats</span><span class="p">[</span><span class="s1">'rating'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rating</span>
    
    <span class="c1"># add player stats detail</span>
    <span class="n">player_stats_detail</span><span class="p">(</span><span class="n">weblink</span><span class="p">)</span>
    
    
    <span class="c1"># print progress --------------------------</span>
    <span class="n">list_stats_top10</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stats</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">index</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
    
    <span class="c1">#Be sure to pause between accessing pages</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">randrange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
    
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>0
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Save-JSON-data-of-FIFA21-EPL-players">
<a class="anchor" href="#Save-JSON-data-of-FIFA21-EPL-players" aria-hidden="true"><span class="octicon octicon-link"></span></a>Save JSON data of FIFA21 EPL players<a class="anchor-link" href="#Save-JSON-data-of-FIFA21-EPL-players"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>

<span class="k">def</span> <span class="nf">save_data</span><span class="p">(</span><span class="n">title</span><span class="p">,</span><span class="n">data</span><span class="p">):</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">,</span> <span class="n">encoding</span> <span class="o">=</span><span class="s1">'utf-8'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">ensure_ascii</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">indent</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
    
<span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span><span class="n">title</span><span class="p">):</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">encoding</span> <span class="o">=</span><span class="s1">'utf-8'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#save_data('FIFA21_EPL_top10.json', list_stats_top10)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Load-data-for-later-use">
<a class="anchor" href="#Load-data-for-later-use" aria-hidden="true"><span class="octicon octicon-link"></span></a>Load data for later use<a class="anchor-link" href="#Load-data-for-later-use"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s2">"C:/Users/Riyan Aditya/Desktop/ML_learning/Project6_EPL_20192020"</span><span class="p">)</span>
<span class="n">FIFA21_data</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="s1">'FIFA21_EPL.json'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Lets see the first data, Kevin De Bruyne</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">FIFA21_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{'Player_name': 'K. De Bruyne',
 'Nationality': 'Belgium',
 'dob': 'Jun 28, 1991',
 'height': '5\'11"',
 'weight': '154lbs',
 'club': 'Manchester City',
 'jersey': '17',
 'c_valid': '2023',
 'c_value': '€129M',
 'wage': '€370K',
 'pos': 'CAM',
 'rating': '91',
 'Crossing': '94',
 'Finishing': '82',
 'Heading Accuracy': '55',
 'Short Passing': '94',
 'Volleys': '82',
 'Dribbling': '88',
 'Curve': '85',
 'FK Accuracy': '83',
 'Long Passing': '93',
 'Ball Control': '92',
 'Acceleration': '77',
 'Spring Speed': '76',
 'Agility': '78',
 'Reactions': '91',
 'Balance': '76',
 'Shot Power': '91',
 'Jumping': '63',
 'Stamina': '89',
 'Strength': '74',
 'Long Shots': '91',
 'Aggression': '76',
 'Interceptions': '66',
 'Positioning': '88',
 'Vision': '94',
 'Penalties': '84',
 'Composure': '91',
 'Defensive Awareness': '68',
 'Standing Tackle': '65',
 'Sliding Tackle': '53',
 'GK Diving': '15',
 'GK Handling': '13',
 'GK Kicking': '5',
 'GK Positioning': '10',
 'GK Reflexes': '13',
 'Traits': ['Injury Prone',
  'Leadership',
  'Early Crosser',
  'Long Passer (AI)',
  'Long Shot Taker (AI)',
  'Playmaker (AI)',
  'Outside Foot Shot']}</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Data-cleaning">
<a class="anchor" href="#Data-cleaning" aria-hidden="true"><span class="octicon octicon-link"></span></a>Data cleaning<a class="anchor-link" href="#Data-cleaning"> </a>
</h1>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">FIFA21_data</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Few things to do:</p>
<ul>
<li>Everything is string. Convert to numeric when needed to be, especially the individual stats</li>
<li>Convert DOB to datetime</li>
<li>Convert height and weight to the SI unit</li>
<li>Convert value and wages to the right unit (eg: no M and no K)</li>
<li>What to do with traits in players? Perhaps ignore for now</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Traits">
<a class="anchor" href="#Traits" aria-hidden="true"><span class="octicon octicon-link"></span></a>Traits<a class="anchor-link" href="#Traits"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First, lets look at the traits</p>
<ul>
<li>How many unique traits are there?</li>
<li>Proportion of players that have traits?</li>
<li>Is it worth keeping?</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Players with no traits</strong>:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">'Traits'</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>197</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>199 from 644 players (~30%) do not have any traits</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Top 5 players that have no traits:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">'Traits'</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()][:</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">Player_name</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>6        N. Kanté
32          Rodri
94     D. Sánchez
115      N. Matić
124      J. Evans
Name: Player_name, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Wow. Kante doesnt have any traits? This could be a mistake from Fifa21 database</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Unique traits</strong>:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">Traits</span><span class="o">.</span><span class="n">explode</span><span class="p">()</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span> 
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array(['Injury Prone', 'Leadership', 'Early Crosser', 'Long Passer (AI)',
       'Long Shot Taker (AI)', 'Playmaker (AI)', 'Outside Foot Shot',
       'GK Long Throw', 'Rushes Out Of Goal', 'Finesse Shot',
       'Speed Dribbler (AI)', 'Chip Shot (AI)', 'Flair', 'Solid Player',
       'Power Header', None, 'Comes For Crosses', 'Team Player',
       'Dives Into Tackles (AI)', 'Technical Dribbler (AI)',
       'Cautious With Crosses', 'Saves with Feet', 'Long Throw-in',
       'Power Free-Kick', 'Giant Throw-in', nan], dtype=object)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">"number of unique traits :"</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Traits</span><span class="o">.</span><span class="n">explode</span><span class="p">()</span><span class="o">.</span><span class="n">unique</span><span class="p">()))</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>number of unique traits : 26
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>26 unique traits. Probably too long if I expand the column similar to how a OHE works</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Is it worth keeping?</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Probably not. Remove them for now</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="s1">'Traits'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df2</span><span class="o">.</span><span class="n">columns</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Index(['Player_name', 'Nationality', 'dob', 'height', 'weight', 'club',
       'jersey', 'c_valid', 'c_value', 'wage', 'pos', 'rating', 'Crossing',
       'Finishing', 'Heading Accuracy', 'Short Passing', 'Volleys',
       'Dribbling', 'Curve', 'FK Accuracy', 'Long Passing', 'Ball Control',
       'Acceleration', 'Spring Speed', 'Agility', 'Reactions', 'Balance',
       'Shot Power', 'Jumping', 'Stamina', 'Strength', 'Long Shots',
       'Aggression', 'Interceptions', 'Positioning', 'Vision', 'Penalties',
       'Composure', 'Defensive Awareness', 'Standing Tackle', 'Sliding Tackle',
       'GK Diving', 'GK Handling', 'GK Kicking', 'GK Positioning',
       'GK Reflexes'],
      dtype='object')</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># fix mistake with column name</span>
<span class="n">df2</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">'Spring Speed'</span><span class="p">:</span><span class="s1">'Sprint Speed'</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Convert-to-numeric">
<a class="anchor" href="#Convert-to-numeric" aria-hidden="true"><span class="octicon octicon-link"></span></a>Convert to numeric<a class="anchor-link" href="#Convert-to-numeric"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><em>DOB to datetime</em></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df2</span><span class="p">[</span><span class="s1">'dob'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s1">'dob'</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df2</span><span class="o">.</span><span class="n">dob</span><span class="o">.</span><span class="n">dtype</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>dtype('&lt;M8[ns]')</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><em>Height to numeric &amp; SI</em></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">height_conversion</span><span class="p">(</span><span class="n">ht</span><span class="p">):</span>
    <span class="c1"># current format is x'x"</span>
    <span class="n">ht2</span> <span class="o">=</span> <span class="n">ht</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">"'"</span><span class="p">)</span>
    <span class="n">ft</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">ht2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">inc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">ht2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">"</span><span class="se">\"</span><span class="s2">"</span><span class="p">,</span><span class="s2">""</span><span class="p">))</span>   <span class="c1"># " is a special character</span>
    <span class="k">return</span> <span class="nb">round</span><span class="p">(((</span><span class="mi">12</span><span class="o">*</span><span class="n">ft</span><span class="p">)</span><span class="o">+</span><span class="n">inc</span><span class="p">)</span><span class="o">*</span><span class="mf">2.54</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>

<span class="n">df2</span><span class="p">[</span><span class="s1">'height'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s1">'height'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">height_conversion</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df2</span><span class="o">.</span><span class="n">height</span><span class="o">.</span><span class="n">dtype</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>dtype('float64')</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><em>Weight to numeric &amp; SI</em></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">weight_conversion</span><span class="p">(</span><span class="n">wt</span><span class="p">):</span>
    <span class="c1"># current format is xxxlbs</span>
    <span class="n">wt2</span> <span class="o">=</span> <span class="n">wt</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'lbs'</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">wt2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mf">0.453592</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>

<span class="n">df2</span><span class="p">[</span><span class="s1">'weight'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s1">'weight'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">weight_conversion</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df2</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">dtype</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>dtype('float64')</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><em>Contract value and wage to numeric</em></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">value_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"K"</span><span class="p">:</span><span class="mi">1000</span><span class="p">,</span> <span class="s2">"M"</span><span class="p">:</span><span class="mi">1000000</span> <span class="p">}</span>

<span class="k">def</span> <span class="nf">money_conversion</span><span class="p">(</span><span class="n">money</span><span class="p">):</span>
    <span class="c1"># current format is €xxxxK</span>
    <span class="n">money</span> <span class="o">=</span> <span class="n">money</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'€'</span><span class="p">,</span><span class="s1">''</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">money</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">value_dict</span><span class="p">:</span>
        <span class="n">num</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="n">money</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">money</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">num</span><span class="p">)</span><span class="o">*</span> <span class="n">value_dict</span><span class="p">[</span><span class="n">values</span><span class="p">])</span>

<span class="n">df2</span><span class="p">[</span><span class="s1">'c_value'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s1">'c_value'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">money_conversion</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">df2</span><span class="p">[</span><span class="s1">'wage'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s1">'wage'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">money_conversion</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df2</span><span class="o">.</span><span class="n">c_value</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span>  <span class="n">df2</span><span class="o">.</span><span class="n">wage</span><span class="o">.</span><span class="n">dtype</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(dtype('float64'), dtype('float64'))</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><em>Convert jersey, rating and individual stats attributes to numeric</em></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df2</span><span class="p">[</span><span class="s1">'jersey'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s1">'jersey'</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">'coerce'</span><span class="p">)</span>
<span class="n">df2</span><span class="p">[</span><span class="s1">'rating'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s1">'rating'</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">'coerce'</span><span class="p">)</span>

<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span>  <span class="n">df2</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">12</span><span class="p">::]:</span>
    <span class="n">df2</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">'coerce'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df3</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Top-players-of-Fifa21">
<a class="anchor" href="#Top-players-of-Fifa21" aria-hidden="true"><span class="octicon octicon-link"></span></a>Top players of Fifa21<a class="anchor-link" href="#Top-players-of-Fifa21"> </a>
</h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Top rated players from each club</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that there can be multiple top rated players per club</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">idx</span> <span class="o">=</span> <span class="n">df3</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">'club'</span><span class="p">])[</span><span class="s1">'rating'</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="nb">max</span><span class="p">)</span> <span class="o">==</span> <span class="n">df3</span><span class="p">[</span><span class="s1">'rating'</span><span class="p">]</span>
<span class="n">top_rated</span> <span class="o">=</span> <span class="n">df3</span><span class="p">[</span><span class="n">idx</span><span class="p">][[</span><span class="s1">'club'</span><span class="p">,</span><span class="s1">'Player_name'</span><span class="p">,</span><span class="s1">'pos'</span><span class="p">,</span><span class="s1">'rating'</span><span class="p">]]</span>
<span class="n">top_rated</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">'club'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>club</th>
      <th>Player_name</th>
      <th>pos</th>
      <th>rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>11</td>
      <td>Arsenal</td>
      <td>P. Aubameyang</td>
      <td>ST</td>
      <td>87</td>
    </tr>
    <tr>
      <td>105</td>
      <td>Aston Villa</td>
      <td>J. Grealish</td>
      <td>CAM</td>
      <td>83</td>
    </tr>
    <tr>
      <td>194</td>
      <td>Brighton &amp; Hove Albion</td>
      <td>L. Trossard</td>
      <td>CAM</td>
      <td>80</td>
    </tr>
    <tr>
      <td>129</td>
      <td>Brighton &amp; Hove Albion</td>
      <td>M. Ryan</td>
      <td>GK</td>
      <td>80</td>
    </tr>
    <tr>
      <td>193</td>
      <td>Brighton &amp; Hove Albion</td>
      <td>L. Dunk</td>
      <td>CB</td>
      <td>80</td>
    </tr>
    <tr>
      <td>77</td>
      <td>Burnley</td>
      <td>N. Pope</td>
      <td>GK</td>
      <td>82</td>
    </tr>
    <tr>
      <td>6</td>
      <td>Chelsea</td>
      <td>N. Kanté</td>
      <td>CDM</td>
      <td>88</td>
    </tr>
    <tr>
      <td>63</td>
      <td>Crystal Palace</td>
      <td>W. Zaha</td>
      <td>CF</td>
      <td>83</td>
    </tr>
    <tr>
      <td>51</td>
      <td>Everton</td>
      <td>Allan</td>
      <td>CDM</td>
      <td>85</td>
    </tr>
    <tr>
      <td>76</td>
      <td>Fulham</td>
      <td>A. Areola</td>
      <td>GK</td>
      <td>82</td>
    </tr>
    <tr>
      <td>84</td>
      <td>Leeds United</td>
      <td>Raphinha</td>
      <td>LM</td>
      <td>82</td>
    </tr>
    <tr>
      <td>68</td>
      <td>Leeds United</td>
      <td>Rodrigo</td>
      <td>ST</td>
      <td>82</td>
    </tr>
    <tr>
      <td>20</td>
      <td>Leicester City</td>
      <td>J. Vardy</td>
      <td>ST</td>
      <td>87</td>
    </tr>
    <tr>
      <td>45</td>
      <td>Leicester City</td>
      <td>W. Ndidi</td>
      <td>CB</td>
      <td>87</td>
    </tr>
    <tr>
      <td>1</td>
      <td>Liverpool</td>
      <td>Alisson</td>
      <td>GK</td>
      <td>90</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Liverpool</td>
      <td>M. Salah</td>
      <td>RW</td>
      <td>90</td>
    </tr>
    <tr>
      <td>3</td>
      <td>Liverpool</td>
      <td>S. Mané</td>
      <td>LW</td>
      <td>90</td>
    </tr>
    <tr>
      <td>4</td>
      <td>Liverpool</td>
      <td>V. van Dijk</td>
      <td>CB</td>
      <td>90</td>
    </tr>
    <tr>
      <td>0</td>
      <td>Manchester City</td>
      <td>K. De Bruyne</td>
      <td>CAM</td>
      <td>91</td>
    </tr>
    <tr>
      <td>18</td>
      <td>Manchester United</td>
      <td>Bruno Fernandes</td>
      <td>CAM</td>
      <td>88</td>
    </tr>
    <tr>
      <td>59</td>
      <td>Newcastle United</td>
      <td>M. Dúbravka</td>
      <td>GK</td>
      <td>83</td>
    </tr>
    <tr>
      <td>156</td>
      <td>Sheffield United</td>
      <td>S. Berge</td>
      <td>CDM</td>
      <td>80</td>
    </tr>
    <tr>
      <td>187</td>
      <td>Sheffield United</td>
      <td>J. Egan</td>
      <td>CB</td>
      <td>80</td>
    </tr>
    <tr>
      <td>189</td>
      <td>Sheffield United</td>
      <td>J. O'Connell</td>
      <td>CB</td>
      <td>80</td>
    </tr>
    <tr>
      <td>92</td>
      <td>Southampton</td>
      <td>D. Ings</td>
      <td>ST</td>
      <td>81</td>
    </tr>
    <tr>
      <td>145</td>
      <td>Southampton</td>
      <td>J. Ward-Prowse</td>
      <td>CM</td>
      <td>81</td>
    </tr>
    <tr>
      <td>10</td>
      <td>Tottenham Hotspur</td>
      <td>H. Kane</td>
      <td>ST</td>
      <td>88</td>
    </tr>
    <tr>
      <td>9</td>
      <td>Tottenham Hotspur</td>
      <td>H. Son</td>
      <td>LM</td>
      <td>88</td>
    </tr>
    <tr>
      <td>153</td>
      <td>West Bromwich Albion</td>
      <td>B. Ivanović</td>
      <td>CB</td>
      <td>79</td>
    </tr>
    <tr>
      <td>96</td>
      <td>West Ham United</td>
      <td>T. Souček</td>
      <td>CDM</td>
      <td>82</td>
    </tr>
    <tr>
      <td>97</td>
      <td>West Ham United</td>
      <td>S. Haller</td>
      <td>ST</td>
      <td>82</td>
    </tr>
    <tr>
      <td>47</td>
      <td>Wolverhampton Wanderers</td>
      <td>R. Jiménez</td>
      <td>ST</td>
      <td>84</td>
    </tr>
    <tr>
      <td>46</td>
      <td>Wolverhampton Wanderers</td>
      <td>Rui Patrício</td>
      <td>GK</td>
      <td>84</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Top rated players per pos</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>These positions are based on what FIFA21 recommend as "Best Position"</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">idx</span> <span class="o">=</span> <span class="n">df3</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">'pos'</span><span class="p">])[</span><span class="s1">'rating'</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="nb">max</span><span class="p">)</span> <span class="o">==</span> <span class="n">df3</span><span class="p">[</span><span class="s1">'rating'</span><span class="p">]</span>
<span class="n">top_rated</span> <span class="o">=</span> <span class="n">df3</span><span class="p">[</span><span class="n">idx</span><span class="p">][[</span><span class="s1">'pos'</span><span class="p">,</span><span class="s1">'club'</span><span class="p">,</span><span class="s1">'Player_name'</span><span class="p">,</span><span class="s1">'rating'</span><span class="p">]]</span>

<span class="c1"># create custom sort so this makes positional sense</span>
<span class="n">custom_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'GK'</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s1">'CB'</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">'LB'</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s1">'RB'</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="s1">'LWB'</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="s1">'RWB'</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="s1">'CDM'</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span> <span class="s1">'CM'</span><span class="p">:</span><span class="mi">7</span><span class="p">,</span> <span class="s1">'CAM'</span><span class="p">:</span><span class="mi">8</span><span class="p">,</span> <span class="s1">'RM'</span><span class="p">:</span><span class="mi">9</span><span class="p">,</span> <span class="s1">'LM'</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span>
              <span class="s1">'RW'</span><span class="p">:</span><span class="mi">11</span><span class="p">,</span> <span class="s1">'LW'</span><span class="p">:</span><span class="mi">12</span><span class="p">,</span> <span class="s1">'CF'</span><span class="p">:</span><span class="mi">13</span><span class="p">,</span> <span class="s1">'ST'</span><span class="p">:</span><span class="mi">14</span><span class="p">}</span>
<span class="n">top_rated</span><span class="p">[</span><span class="s1">'rank'</span><span class="p">]</span> <span class="o">=</span> <span class="n">top_rated</span><span class="p">[</span><span class="s1">'pos'</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">custom_dict</span><span class="p">)</span>
<span class="n">top_pos</span> <span class="o">=</span> <span class="n">top_rated</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">'rank'</span><span class="p">)</span>
<span class="n">top_pos</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">'rank'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pos</th>
      <th>club</th>
      <th>Player_name</th>
      <th>rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>GK</td>
      <td>Liverpool</td>
      <td>Alisson</td>
      <td>90</td>
    </tr>
    <tr>
      <td>4</td>
      <td>CB</td>
      <td>Liverpool</td>
      <td>V. van Dijk</td>
      <td>90</td>
    </tr>
    <tr>
      <td>13</td>
      <td>LB</td>
      <td>Liverpool</td>
      <td>A. Robertson</td>
      <td>87</td>
    </tr>
    <tr>
      <td>12</td>
      <td>RB</td>
      <td>Liverpool</td>
      <td>T. Alexander-Arnold</td>
      <td>87</td>
    </tr>
    <tr>
      <td>89</td>
      <td>LWB</td>
      <td>Manchester City</td>
      <td>B. Mendy</td>
      <td>82</td>
    </tr>
    <tr>
      <td>54</td>
      <td>RWB</td>
      <td>Manchester City</td>
      <td>João Cancelo</td>
      <td>84</td>
    </tr>
    <tr>
      <td>6</td>
      <td>CDM</td>
      <td>Chelsea</td>
      <td>N. Kanté</td>
      <td>88</td>
    </tr>
    <tr>
      <td>23</td>
      <td>CM</td>
      <td>Manchester United</td>
      <td>P. Pogba</td>
      <td>86</td>
    </tr>
    <tr>
      <td>50</td>
      <td>CM</td>
      <td>Chelsea</td>
      <td>M. Kovačić</td>
      <td>86</td>
    </tr>
    <tr>
      <td>0</td>
      <td>CAM</td>
      <td>Manchester City</td>
      <td>K. De Bruyne</td>
      <td>91</td>
    </tr>
    <tr>
      <td>34</td>
      <td>RM</td>
      <td>Manchester United</td>
      <td>M. Rashford</td>
      <td>86</td>
    </tr>
    <tr>
      <td>9</td>
      <td>LM</td>
      <td>Tottenham Hotspur</td>
      <td>H. Son</td>
      <td>88</td>
    </tr>
    <tr>
      <td>2</td>
      <td>RW</td>
      <td>Liverpool</td>
      <td>M. Salah</td>
      <td>90</td>
    </tr>
    <tr>
      <td>3</td>
      <td>LW</td>
      <td>Liverpool</td>
      <td>S. Mané</td>
      <td>90</td>
    </tr>
    <tr>
      <td>15</td>
      <td>CF</td>
      <td>Liverpool</td>
      <td>Roberto Firmino</td>
      <td>87</td>
    </tr>
    <tr>
      <td>5</td>
      <td>ST</td>
      <td>Manchester City</td>
      <td>S. Agüero</td>
      <td>89</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Some weird result here. Right forward maybe, but I would not put Rasford as a Right milfielder</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Top rated players per original country</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Unique nationalities of Prem players</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df3</span><span class="o">.</span><span class="n">Nationality</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(60,)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>List of top players per nationality of origin:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">idx</span> <span class="o">=</span> <span class="n">df3</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">'Nationality'</span><span class="p">])[</span><span class="s1">'rating'</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="nb">max</span><span class="p">)</span> <span class="o">==</span> <span class="n">df3</span><span class="p">[</span><span class="s1">'rating'</span><span class="p">]</span>
<span class="n">top_rated</span> <span class="o">=</span> <span class="n">df3</span><span class="p">[</span><span class="n">idx</span><span class="p">][[</span><span class="s1">'Nationality'</span><span class="p">,</span><span class="s1">'club'</span><span class="p">,</span><span class="s1">'Player_name'</span><span class="p">,</span><span class="s1">'pos'</span><span class="p">,</span><span class="s1">'rating'</span><span class="p">]]</span>
<span class="n">top_rated</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">'Nationality'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Nationality</th>
      <th>club</th>
      <th>Player_name</th>
      <th>pos</th>
      <th>rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>33</td>
      <td>Algeria</td>
      <td>Manchester City</td>
      <td>R. Mahrez</td>
      <td>RW</td>
      <td>85</td>
    </tr>
    <tr>
      <td>5</td>
      <td>Argentina</td>
      <td>Manchester City</td>
      <td>S. Agüero</td>
      <td>ST</td>
      <td>89</td>
    </tr>
    <tr>
      <td>129</td>
      <td>Australia</td>
      <td>Brighton &amp; Hove Albion</td>
      <td>M. Ryan</td>
      <td>GK</td>
      <td>80</td>
    </tr>
    <tr>
      <td>390</td>
      <td>Austria</td>
      <td>Leicester City</td>
      <td>C. Fuchs</td>
      <td>CDM</td>
      <td>74</td>
    </tr>
    <tr>
      <td>0</td>
      <td>Belgium</td>
      <td>Manchester City</td>
      <td>K. De Bruyne</td>
      <td>CAM</td>
      <td>91</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>112</td>
      <td>Ukraine</td>
      <td>Manchester City</td>
      <td>O. Zinchenko</td>
      <td>CM</td>
      <td>81</td>
    </tr>
    <tr>
      <td>80</td>
      <td>United States</td>
      <td>Chelsea</td>
      <td>C. Pulisic</td>
      <td>CAM</td>
      <td>82</td>
    </tr>
    <tr>
      <td>43</td>
      <td>Uruguay</td>
      <td>Manchester United</td>
      <td>E. Cavani</td>
      <td>ST</td>
      <td>84</td>
    </tr>
    <tr>
      <td>60</td>
      <td>Wales</td>
      <td>Tottenham Hotspur</td>
      <td>G. Bale</td>
      <td>RW</td>
      <td>83</td>
    </tr>
    <tr>
      <td>297</td>
      <td>Zimbabwe</td>
      <td>Aston Villa</td>
      <td>M. Nakamba</td>
      <td>CDM</td>
      <td>76</td>
    </tr>
  </tbody>
</table>
<p>64 rows × 5 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Top player based on some stats</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Best crosser</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df3</span><span class="p">[[</span><span class="s1">'Player_name'</span><span class="p">,</span><span class="s1">'club'</span><span class="p">,</span><span class="s1">'pos'</span><span class="p">,</span><span class="s1">'Crossing'</span><span class="p">]]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df3</span><span class="p">[</span><span class="s1">'Crossing'</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()]</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Player_name       K. De Bruyne
club           Manchester City
pos                        CAM
Crossing                    94
Name: 0, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Best short passer</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df3</span><span class="p">[[</span><span class="s1">'Player_name'</span><span class="p">,</span><span class="s1">'club'</span><span class="p">,</span><span class="s1">'pos'</span><span class="p">,</span><span class="s1">'Short Passing'</span><span class="p">]]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df3</span><span class="p">[</span><span class="s1">'Short Passing'</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()]</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Player_name         K. De Bruyne
club             Manchester City
pos                          CAM
Short Passing                 94
Name: 0, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Best long passer</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df3</span><span class="p">[[</span><span class="s1">'Player_name'</span><span class="p">,</span><span class="s1">'club'</span><span class="p">,</span><span class="s1">'pos'</span><span class="p">,</span><span class="s1">'Long Passing'</span><span class="p">]]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df3</span><span class="p">[</span><span class="s1">'Long Passing'</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()]</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Player_name        K. De Bruyne
club            Manchester City
pos                         CAM
Long Passing                 93
Name: 0, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Best header</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df3</span><span class="p">[[</span><span class="s1">'Player_name'</span><span class="p">,</span><span class="s1">'club'</span><span class="p">,</span><span class="s1">'pos'</span><span class="p">,</span><span class="s1">'Heading Accuracy'</span><span class="p">]]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df3</span><span class="p">[</span><span class="s1">'Heading Accuracy'</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()]</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Player_name         O. Giroud
club                  Chelsea
pos                        ST
Heading Accuracy           90
Name: 130, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Best finisher</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df3</span><span class="p">[[</span><span class="s1">'Player_name'</span><span class="p">,</span><span class="s1">'club'</span><span class="p">,</span><span class="s1">'pos'</span><span class="p">,</span><span class="s1">'Finishing'</span><span class="p">]]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df3</span><span class="p">[</span><span class="s1">'Finishing'</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()]</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Player_name          S. Agüero
club           Manchester City
pos                         ST
Finishing                   94
Name: 5, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Best FK taker</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df3</span><span class="p">[[</span><span class="s1">'Player_name'</span><span class="p">,</span><span class="s1">'club'</span><span class="p">,</span><span class="s1">'pos'</span><span class="p">,</span><span class="s1">'FK Accuracy'</span><span class="p">]]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df3</span><span class="p">[</span><span class="s1">'FK Accuracy'</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()]</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Player_name    J. Ward-Prowse
club              Southampton
pos                        CM
FK Accuracy                91
Name: 145, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Best PK taker</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df3</span><span class="p">[[</span><span class="s1">'Player_name'</span><span class="p">,</span><span class="s1">'club'</span><span class="p">,</span><span class="s1">'pos'</span><span class="p">,</span><span class="s1">'Penalties'</span><span class="p">]]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df3</span><span class="p">[</span><span class="s1">'Penalties'</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()]</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Player_name                 R. Jiménez
club           Wolverhampton Wanderers
pos                                 ST
Penalties                           92
Name: 47, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Best volleyer</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df3</span><span class="p">[[</span><span class="s1">'Player_name'</span><span class="p">,</span><span class="s1">'club'</span><span class="p">,</span><span class="s1">'pos'</span><span class="p">,</span><span class="s1">'Volleys'</span><span class="p">]]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df3</span><span class="p">[</span><span class="s1">'Volleys'</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()]</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Player_name    J. Rodríguez
club                Everton
pos                     CAM
Volleys                  90
Name: 67, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Highest shot power</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df3</span><span class="p">[[</span><span class="s1">'Player_name'</span><span class="p">,</span><span class="s1">'club'</span><span class="p">,</span><span class="s1">'pos'</span><span class="p">,</span><span class="s1">'Shot Power'</span><span class="p">]]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df3</span><span class="p">[</span><span class="s1">'Shot Power'</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()]</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Player_name       K. De Bruyne
club           Manchester City
pos                        CAM
Shot Power                  91
Name: 0, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Speed merchant and acceleration</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df3</span><span class="p">[[</span><span class="s1">'Player_name'</span><span class="p">,</span><span class="s1">'club'</span><span class="p">,</span><span class="s1">'pos'</span><span class="p">,</span><span class="s1">'Sprint Speed'</span><span class="p">]]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df3</span><span class="p">[</span><span class="s1">'Sprint Speed'</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()]</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Player_name                Adama Traoré
club            Wolverhampton Wanderers
pos                                  RM
Sprint Speed                         96
Name: 155, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df3</span><span class="p">[[</span><span class="s1">'Player_name'</span><span class="p">,</span><span class="s1">'club'</span><span class="p">,</span><span class="s1">'pos'</span><span class="p">,</span><span class="s1">'Acceleration'</span><span class="p">]]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df3</span><span class="p">[</span><span class="s1">'Acceleration'</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()]</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Player_name                Adama Traoré
club            Wolverhampton Wanderers
pos                                  RM
Acceleration                         97
Name: 155, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Dribbler</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df3</span><span class="p">[[</span><span class="s1">'Player_name'</span><span class="p">,</span><span class="s1">'club'</span><span class="p">,</span><span class="s1">'pos'</span><span class="p">,</span><span class="s1">'Dribbling'</span><span class="p">]]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df3</span><span class="p">[</span><span class="s1">'Dribbling'</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()]</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Player_name     Bernardo Silva
club           Manchester City
pos                         RW
Dribbling                   92
Name: 17, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df3</span><span class="p">[[</span><span class="s1">'Player_name'</span><span class="p">,</span><span class="s1">'club'</span><span class="p">,</span><span class="s1">'pos'</span><span class="p">,</span><span class="s1">'Ball Control'</span><span class="p">]]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df3</span><span class="p">[</span><span class="s1">'Ball Control'</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()]</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Player_name        K. De Bruyne
club            Manchester City
pos                         CAM
Ball Control                 92
Name: 0, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Best stamina</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df3</span><span class="p">[[</span><span class="s1">'Player_name'</span><span class="p">,</span><span class="s1">'club'</span><span class="p">,</span><span class="s1">'pos'</span><span class="p">,</span><span class="s1">'Stamina'</span><span class="p">]]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df3</span><span class="p">[</span><span class="s1">'Stamina'</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()]</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Player_name    N. Kanté
club            Chelsea
pos                 CDM
Stamina              96
Name: 6, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Best strength</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df3</span><span class="p">[[</span><span class="s1">'Player_name'</span><span class="p">,</span><span class="s1">'club'</span><span class="p">,</span><span class="s1">'pos'</span><span class="p">,</span><span class="s1">'Strength'</span><span class="p">]]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df3</span><span class="p">[</span><span class="s1">'Strength'</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()]</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Player_name                    W. Boly
club           Wolverhampton Wanderers
pos                                 CB
Strength                            93
Name: 126, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Best positioning</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df3</span><span class="p">[[</span><span class="s1">'Player_name'</span><span class="p">,</span><span class="s1">'club'</span><span class="p">,</span><span class="s1">'pos'</span><span class="p">,</span><span class="s1">'Positioning'</span><span class="p">]]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df3</span><span class="p">[</span><span class="s1">'Positioning'</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()]</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Player_name          S. Agüero
club           Manchester City
pos                         ST
Positioning                 94
Name: 5, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Best vision</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df3</span><span class="p">[[</span><span class="s1">'Player_name'</span><span class="p">,</span><span class="s1">'club'</span><span class="p">,</span><span class="s1">'pos'</span><span class="p">,</span><span class="s1">'Vision'</span><span class="p">]]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df3</span><span class="p">[</span><span class="s1">'Vision'</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()]</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Player_name       K. De Bruyne
club           Manchester City
pos                        CAM
Vision                      94
Name: 0, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Best composure</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df3</span><span class="p">[[</span><span class="s1">'Player_name'</span><span class="p">,</span><span class="s1">'club'</span><span class="p">,</span><span class="s1">'pos'</span><span class="p">,</span><span class="s1">'Composure'</span><span class="p">]]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df3</span><span class="p">[</span><span class="s1">'Composure'</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()]</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Player_name       K. De Bruyne
club           Manchester City
pos                        CAM
Composure                   91
Name: 0, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Best defensive awareness</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df3</span><span class="p">[[</span><span class="s1">'Player_name'</span><span class="p">,</span><span class="s1">'club'</span><span class="p">,</span><span class="s1">'pos'</span><span class="p">,</span><span class="s1">'Defensive Awareness'</span><span class="p">]]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df3</span><span class="p">[</span><span class="s1">'Defensive Awareness'</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()]</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Player_name            V. van Dijk
club                     Liverpool
pos                             CB
Defensive Awareness             93
Name: 4, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Interceptions</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df3</span><span class="p">[[</span><span class="s1">'Player_name'</span><span class="p">,</span><span class="s1">'club'</span><span class="p">,</span><span class="s1">'pos'</span><span class="p">,</span><span class="s1">'Interceptions'</span><span class="p">]]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df3</span><span class="p">[</span><span class="s1">'Interceptions'</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()]</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Player_name      N. Kanté
club              Chelsea
pos                   CDM
Interceptions          91
Name: 6, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Best sliding tackle</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df3</span><span class="p">[[</span><span class="s1">'Player_name'</span><span class="p">,</span><span class="s1">'club'</span><span class="p">,</span><span class="s1">'pos'</span><span class="p">,</span><span class="s1">'Sliding Tackle'</span><span class="p">]]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df3</span><span class="p">[</span><span class="s1">'Sliding Tackle'</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()]</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Player_name          A. Wan-Bissaka
club              Manchester United
pos                              RB
Sliding Tackle                   90
Name: 57, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Best GK reflexes</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df3</span><span class="p">[[</span><span class="s1">'Player_name'</span><span class="p">,</span><span class="s1">'club'</span><span class="p">,</span><span class="s1">'pos'</span><span class="p">,</span><span class="s1">'GK Reflexes'</span><span class="p">]]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df3</span><span class="p">[</span><span class="s1">'GK Reflexes'</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()]</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Player_name            H. Lloris
club           Tottenham Hotspur
pos                           GK
GK Reflexes                   90
Name: 19, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Best GK kicking</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df3</span><span class="p">[[</span><span class="s1">'Player_name'</span><span class="p">,</span><span class="s1">'club'</span><span class="p">,</span><span class="s1">'pos'</span><span class="p">,</span><span class="s1">'GK Kicking'</span><span class="p">]]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df3</span><span class="p">[</span><span class="s1">'GK Kicking'</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()]</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Player_name            Ederson
club           Manchester City
pos                         GK
GK Kicking                  93
Name: 7, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Tallest player (in cm)</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df3</span><span class="p">[[</span><span class="s1">'Player_name'</span><span class="p">,</span><span class="s1">'club'</span><span class="p">,</span><span class="s1">'pos'</span><span class="p">,</span><span class="s1">'height'</span><span class="p">]]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df3</span><span class="p">[</span><span class="s1">'height'</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()]</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Player_name    N. Pope
club           Burnley
pos                 GK
height             201
Name: 77, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Heaviest player (kg)</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df3</span><span class="p">[[</span><span class="s1">'Player_name'</span><span class="p">,</span><span class="s1">'club'</span><span class="p">,</span><span class="s1">'pos'</span><span class="p">,</span><span class="s1">'weight'</span><span class="p">]]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df3</span><span class="p">[</span><span class="s1">'weight'</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()]</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Player_name         W. Morgan
club           Leicester City
pos                        CB
weight                    101
Name: 389, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Top player based on wages and salaries</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Highest wages</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df3</span><span class="p">[[</span><span class="s1">'Player_name'</span><span class="p">,</span><span class="s1">'club'</span><span class="p">,</span><span class="s1">'pos'</span><span class="p">,</span><span class="s1">'wage'</span><span class="p">]]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df3</span><span class="p">[</span><span class="s1">'wage'</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()]</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Player_name       K. De Bruyne
club           Manchester City
pos                        CAM
wage                    370000
Name: 0, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Highest contract values</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df3</span><span class="p">[[</span><span class="s1">'Player_name'</span><span class="p">,</span><span class="s1">'club'</span><span class="p">,</span><span class="s1">'pos'</span><span class="p">,</span><span class="s1">'c_value'</span><span class="p">]]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df3</span><span class="p">[</span><span class="s1">'c_value'</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()]</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Player_name       K. De Bruyne
club           Manchester City
pos                        CAM
c_value               1.29e+08
Name: 0, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Top earner per club</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">idx</span> <span class="o">=</span> <span class="n">df3</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">'club'</span><span class="p">])[</span><span class="s1">'wage'</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="nb">max</span><span class="p">)</span> <span class="o">==</span> <span class="n">df3</span><span class="p">[</span><span class="s1">'wage'</span><span class="p">]</span>
<span class="n">top_rated</span> <span class="o">=</span> <span class="n">df3</span><span class="p">[</span><span class="n">idx</span><span class="p">][[</span><span class="s1">'club'</span><span class="p">,</span><span class="s1">'Player_name'</span><span class="p">,</span><span class="s1">'pos'</span><span class="p">,</span><span class="s1">'rating'</span><span class="p">,</span><span class="s1">'wage'</span><span class="p">]]</span>
<span class="n">top_rated</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">'club'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>club</th>
      <th>Player_name</th>
      <th>pos</th>
      <th>rating</th>
      <th>wage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>11</td>
      <td>Arsenal</td>
      <td>P. Aubameyang</td>
      <td>ST</td>
      <td>87</td>
      <td>170000.0</td>
    </tr>
    <tr>
      <td>165</td>
      <td>Aston Villa</td>
      <td>R. Barkley</td>
      <td>CAM</td>
      <td>81</td>
      <td>81000.0</td>
    </tr>
    <tr>
      <td>194</td>
      <td>Brighton &amp; Hove Albion</td>
      <td>L. Trossard</td>
      <td>CAM</td>
      <td>80</td>
      <td>56000.0</td>
    </tr>
    <tr>
      <td>193</td>
      <td>Brighton &amp; Hove Albion</td>
      <td>L. Dunk</td>
      <td>CB</td>
      <td>80</td>
      <td>56000.0</td>
    </tr>
    <tr>
      <td>192</td>
      <td>Burnley</td>
      <td>C. Wood</td>
      <td>ST</td>
      <td>78</td>
      <td>63000.0</td>
    </tr>
    <tr>
      <td>6</td>
      <td>Chelsea</td>
      <td>N. Kanté</td>
      <td>CDM</td>
      <td>88</td>
      <td>190000.0</td>
    </tr>
    <tr>
      <td>63</td>
      <td>Crystal Palace</td>
      <td>W. Zaha</td>
      <td>CF</td>
      <td>83</td>
      <td>89000.0</td>
    </tr>
    <tr>
      <td>51</td>
      <td>Everton</td>
      <td>Allan</td>
      <td>CDM</td>
      <td>85</td>
      <td>115000.0</td>
    </tr>
    <tr>
      <td>226</td>
      <td>Fulham</td>
      <td>A. Mitrović</td>
      <td>ST</td>
      <td>79</td>
      <td>90000.0</td>
    </tr>
    <tr>
      <td>68</td>
      <td>Leeds United</td>
      <td>Rodrigo</td>
      <td>ST</td>
      <td>82</td>
      <td>140000.0</td>
    </tr>
    <tr>
      <td>20</td>
      <td>Leicester City</td>
      <td>J. Vardy</td>
      <td>ST</td>
      <td>87</td>
      <td>170000.0</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Liverpool</td>
      <td>M. Salah</td>
      <td>RW</td>
      <td>90</td>
      <td>250000.0</td>
    </tr>
    <tr>
      <td>3</td>
      <td>Liverpool</td>
      <td>S. Mané</td>
      <td>LW</td>
      <td>90</td>
      <td>250000.0</td>
    </tr>
    <tr>
      <td>0</td>
      <td>Manchester City</td>
      <td>K. De Bruyne</td>
      <td>CAM</td>
      <td>91</td>
      <td>370000.0</td>
    </tr>
    <tr>
      <td>18</td>
      <td>Manchester United</td>
      <td>Bruno Fernandes</td>
      <td>CAM</td>
      <td>88</td>
      <td>195000.0</td>
    </tr>
    <tr>
      <td>173</td>
      <td>Newcastle United</td>
      <td>C. Wilson</td>
      <td>ST</td>
      <td>78</td>
      <td>48000.0</td>
    </tr>
    <tr>
      <td>231</td>
      <td>Sheffield United</td>
      <td>J. Fleck</td>
      <td>CM</td>
      <td>77</td>
      <td>38000.0</td>
    </tr>
    <tr>
      <td>230</td>
      <td>Sheffield United</td>
      <td>O. Norwood</td>
      <td>CM</td>
      <td>77</td>
      <td>38000.0</td>
    </tr>
    <tr>
      <td>92</td>
      <td>Southampton</td>
      <td>D. Ings</td>
      <td>ST</td>
      <td>81</td>
      <td>75000.0</td>
    </tr>
    <tr>
      <td>10</td>
      <td>Tottenham Hotspur</td>
      <td>H. Kane</td>
      <td>ST</td>
      <td>88</td>
      <td>220000.0</td>
    </tr>
    <tr>
      <td>365</td>
      <td>West Bromwich Albion</td>
      <td>M. Phillips</td>
      <td>RM</td>
      <td>74</td>
      <td>65000.0</td>
    </tr>
    <tr>
      <td>97</td>
      <td>West Ham United</td>
      <td>S. Haller</td>
      <td>ST</td>
      <td>82</td>
      <td>58000.0</td>
    </tr>
    <tr>
      <td>47</td>
      <td>Wolverhampton Wanderers</td>
      <td>R. Jiménez</td>
      <td>ST</td>
      <td>84</td>
      <td>140000.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Total wages per club</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">grouped</span> <span class="o">=</span> <span class="n">df3</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'club'</span><span class="p">)[</span><span class="s1">'wage'</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">grouped</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">'wage'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>club</th>
      <th>wage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>11</td>
      <td>Manchester City</td>
      <td>3552000.0</td>
    </tr>
    <tr>
      <td>12</td>
      <td>Manchester United</td>
      <td>2984000.0</td>
    </tr>
    <tr>
      <td>10</td>
      <td>Liverpool</td>
      <td>2964000.0</td>
    </tr>
    <tr>
      <td>16</td>
      <td>Tottenham Hotspur</td>
      <td>2503000.0</td>
    </tr>
    <tr>
      <td>4</td>
      <td>Chelsea</td>
      <td>2371000.0</td>
    </tr>
    <tr>
      <td>0</td>
      <td>Arsenal</td>
      <td>2116000.0</td>
    </tr>
    <tr>
      <td>6</td>
      <td>Everton</td>
      <td>1835000.0</td>
    </tr>
    <tr>
      <td>9</td>
      <td>Leicester City</td>
      <td>1817000.0</td>
    </tr>
    <tr>
      <td>7</td>
      <td>Fulham</td>
      <td>1642000.0</td>
    </tr>
    <tr>
      <td>8</td>
      <td>Leeds United</td>
      <td>1375000.0</td>
    </tr>
    <tr>
      <td>19</td>
      <td>Wolverhampton Wanderers</td>
      <td>1299000.0</td>
    </tr>
    <tr>
      <td>5</td>
      <td>Crystal Palace</td>
      <td>1212000.0</td>
    </tr>
    <tr>
      <td>17</td>
      <td>West Bromwich Albion</td>
      <td>1103000.0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>Aston Villa</td>
      <td>1102000.0</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Brighton &amp; Hove Albion</td>
      <td>1049000.0</td>
    </tr>
    <tr>
      <td>3</td>
      <td>Burnley</td>
      <td>982000.0</td>
    </tr>
    <tr>
      <td>13</td>
      <td>Newcastle United</td>
      <td>978000.0</td>
    </tr>
    <tr>
      <td>15</td>
      <td>Southampton</td>
      <td>918000.0</td>
    </tr>
    <tr>
      <td>18</td>
      <td>West Ham United</td>
      <td>833000.0</td>
    </tr>
    <tr>
      <td>14</td>
      <td>Sheffield United</td>
      <td>652000.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I am not sure the wages in FIFA21 reflect the real wages of these players</p>

</div>
</div>
</div>
</div>



  </div><a class="u-url" href="/MyBlog/web%20scrap/data%20viz/ml/2020/11/09/FIFA21-EPL-pos-pred.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/MyBlog/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/MyBlog/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/MyBlog/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Riyan&#39;s blog on his journey to become a Data Scientist.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/fastai" title="fastai"><svg class="svg-icon grey"><use xlink:href="/MyBlog/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/fastdotai" title="fastdotai"><svg class="svg-icon grey"><use xlink:href="/MyBlog/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
